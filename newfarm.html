<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini Farm â€” Ù…Ø²Ø±Ø¹ØªÙŠ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</title>
<style>
:root{
  --bg:#f0f6ef;
  --panel:#ffffff;
  --accent:#4caf50;
  --tile:#d9ead3;
  --soil:#b07a4b;
  --ready:#ffd54f;
  font-family: "Segoe UI", Tahoma, Arial, sans-serif;
}
html,body{height:100%; margin:0; background:var(--bg); color:#333}
.wrap{max-width:1100px;margin:18px auto;padding:12px;display:flex;gap:16px;align-items:flex-start}
.left{flex:1; background:var(--panel); padding:12px;border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.06)}
.right{width:300px;background:var(--panel); padding:12px;border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.06)}
h1{margin:0 0 8px;font-size:20px}
.row {display:flex;gap:8px;margin-bottom:8px;align-items:center}
.status {display:flex;gap:8px;flex-wrap:wrap}
.chip{background:#f8fff8;padding:8px 10px;border-radius:8px;font-weight:600;color:#144d14;display:flex;align-items:center;gap:8px}
.grid{display:grid; grid-template-columns: repeat(5, 1fr); gap:8px; margin-top:12px}
.tile{background:var(--tile); height:96px;border-radius:8px;display:flex;align-items:center;justify-content:center;position:relative;cursor:pointer; user-select:none; border:2px solid rgba(0,0,0,0.03)}
.tile .info{position:absolute; left:6px; top:6px; font-size:12px; background:rgba(255,255,255,0.75); padding:2px 6px;border-radius:4px}
.soil{width:80%;height:60%; background:var(--soil); border-radius:6px; display:flex;align-items:center;justify-content:center; font-size:22px; color:white}
.progress{position:absolute; right:6px; bottom:6px; font-size:12px; background:rgba(255,255,255,0.85); padding:2px 6px;border-radius:4px}
select, button{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08); background:white; cursor:pointer}
button.primary{background:var(--accent); color:white; border:none}
.small{font-size:13px;color:#666}
.log{height:200px; overflow:auto; padding:8px; border-radius:8px; background:#fff; border:1px dashed rgba(0,0,0,0.04); margin-top:12px}
.tile.ready{box-shadow:0 0 0 4px rgba(255,213,79,0.12)}
.footer{font-size:12px;color:#666;margin-top:10px}
@media(max-width:880px){.wrap{flex-direction:column}.right{width:100%}}
</style>
</head>
<body>
<div class="wrap">
  <div class="left">
    <h1>Ù…Ø²Ø±Ø¹ØªÙŠ â€” Mini Farm</h1>
    <div class="row status">
      <div class="chip">ğŸ’° <span id="coins">0</span> Coins</div>
      <div class="chip">â­ <span id="xp">0</span> XP</div>
      <div class="chip small">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <strong id="level">1</strong></div>
    </div>

    <div class="row">
      <div class="small">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø°Ø±Ø© Ù„Ù„Ø²Ø±Ø§Ø¹Ø©:</div>
      <select id="seedSelect"></select>
      <button id="plantBtn" class="primary">Ø²Ø±Ø¹</button>
      <button id="harvestAllBtn">Ø­ØµØ§Ø¯ Ø§Ù„ÙƒÙ„</button>
      <button id="resetBtn" style="margin-left:auto">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
    </div>

    <div class="grid" id="grid"></div>
    <div class="footer">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…Ø±Ø¨Ø¹ Ù„Ø²Ø±Ø¹Ù‡ Ø£Ùˆ Ù„Ø­ØµØ§Ø¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¬Ø§Ù‡Ø²Ù‹Ø§. Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</div>
  </div>

  <div class="right">
    <h1>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</h1>
    <div id="cropList" class="small"></div>

    <h1 style="margin-top:14px">Ø§Ù„Ù…Ø®Ø²Ù†</h1>
    <button id="toggleStorageBtn">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø®Ø²Ù†</button>
    <div id="storageList" class="small" style="display:none"></div>
    <button id="sellAllBtn" style="margin-top:6px; display:none">Ø¨ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</button>

    <h1 style="margin-top:14px">Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h1>
    <div id="log" class="log"></div>
  </div>
</div>

<script>
const GRID_ROWS=5, GRID_COLS=5, SAVE_KEY='mini_farm_full';
const CROPS={
  wheat:{name:'Ù‚Ù…Ø­',emoji:'ğŸŒ¾',growSeconds:60,cost:5,yield:10,xp:1},
  tomato:{name:'Ø·Ù…Ø§Ø·Ù…',emoji:'ğŸ…',growSeconds:120,cost:10,yield:25,xp:3},
  corn:{name:'Ø°Ø±Ø©',emoji:'ğŸŒ½',growSeconds:300,cost:25,yield:70,xp:7}
};
let state={coins:50,xp:0,tiles:[],storage:{wheat:0,tomato:0,corn:0},lastSave:Date.now()};

const gridEl=document.getElementById('grid'), coinsEl=document.getElementById('coins'), xpEl=document.getElementById('xp'), lvlEl=document.getElementById('level'), seedSelect=document.getElementById('seedSelect'), cropList=document.getElementById('cropList'), logEl=document.getElementById('log'), plantBtn=document.getElementById('plantBtn'), harvestAllBtn=document.getElementById('harvestAllBtn'), resetBtn=document.getElementById('resetBtn'), toggleStorageBtn=document.getElementById('toggleStorageBtn'), storageList=document.getElementById('storageList'), sellAllBtn=document.getElementById('sellAllBtn');

function init(){
  const saved=localStorage.getItem(SAVE_KEY);
  if(saved) try{state=JSON.parse(saved);}catch(e){localStorage.removeItem(SAVE_KEY);}
  if(!state.tiles||state.tiles.length!==GRID_ROWS*GRID_COLS) state.tiles=Array(GRID_ROWS*GRID_COLS).fill(null).map(()=>({cropId:null,plantedAt:0,readyAt:0}));
  for(const id in CROPS){
    let opt=document.createElement('option'); opt.value=id; opt.textContent=`${CROPS[id].emoji} ${CROPS[id].name} â€” ØªÙƒÙ„ÙØ© ${CROPS[id].cost}`; seedSelect.appendChild(opt);
    let div=document.createElement('div'); div.textContent=`${CROPS[id].emoji} ${CROPS[id].name} â€” ÙˆÙ‚Øª Ø§Ù„Ù†Ù…Ùˆ ${CROPS[id].growSeconds}s â€” Ù…Ø­ØµÙˆÙ„ ${CROPS[id].yield} Coins`; cropList.appendChild(div);
  }
  gridEl.innerHTML=''; for(let i=0;i<GRID_ROWS*GRID_COLS;i++){ let t=document.createElement('div'); t.className='tile'; t.dataset.index=i; t.onclick=()=>onTileClick(i); t.innerHTML=`<div class="info" id="info-${i}"></div><div class="soil" id="soil-${i}">ğŸŸ«</div><div class="progress" id="prog-${i}"></div>`; gridEl.appendChild(t);}
  attachButtons(); refreshUI(); refreshStorageUI(); startTicker(); log('Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø© â€” Ù„Ø¯ÙŠÙƒ '+state.coins+' Ø¹Ù…Ù„Ø§Øª Ù„Ù„Ø¨Ø¯Ø¡');
}

function attachButtons(){
  plantBtn.onclick=()=>{ const idx=state.tiles.findIndex(t=>!t.cropId); if(idx===-1){alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø¨Ø¹Ø§Øª ÙØ§Ø±ØºØ©.'); return;} plantAt(idx);}
  harvestAllBtn.onclick=harvestAll;
  resetBtn.onclick=()=>{if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ')) resetGame();}
  toggleStorageBtn.onclick=()=>{const visible=storageList.style.display==='block'; storageList.style.display=visible?'none':'block'; sellAllBtn.style.display=visible?'none':'inline-block'; refreshStorageUI();}
  sellAllBtn.onclick=()=>{let total=0; for(const id in state.storage){total+=state.storage[id]*CROPS[id].yield; state.storage[id]=0;} state.coins+=total; log(`ØªÙ… Ø¨ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ø®Ø²Ù† +${total} Coins`); save(); refreshUI(); refreshStorageUI();}
}

function plantAt(index){
  const cropId=seedSelect.value, crop=CROPS[cropId]; if(!crop)return;
  if(state.tiles[index].cropId){log('Ø§Ù„Ù…Ø±Ø¨Ø¹ Ù…Ø´ ÙØ§Ø±Øº!'); return;}
  if(state.coins<crop.cost){alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù…Ø§ ÙŠÙƒÙÙŠ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Øª'); return;}
  const now=Date.now(); state.coins-=crop.cost; state.tiles[index]={cropId,plantedAt:now,readyAt:now+crop.growSeconds*1000}; log(`Ø²Ø±Ø¹Øª ${crop.emoji} ${crop.name} ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ ${index+1} â€” Ø¬Ø§Ù‡Ø² Ø¨Ø¹Ø¯ ${crop.growSeconds}s`); save(); refreshUI();
}

function onTileClick(index){
  const t=state.tiles[index]; if(!t||!t.cropId){plantAt(index); return;}
  const now=Date.now(); if(now>=t.readyAt){harvestAt(index);}else{alert(`Ø§Ù„Ù…Ø­ØµÙˆÙ„ Ù„Ù… ÙŠÙ†Ø¶Ø¬ Ø¨Ø¹Ø¯. ØªØ¨Ù‚Ù‘Ù‰ ${Math.ceil((t.readyAt-now)/1000)} Ø«Ø§Ù†ÙŠØ©.`);}
}

function harvestAt(index){
  const t=state.tiles[index]; if(!t||!t.cropId) return; const crop=CROPS[t.cropId]; const now=Date.now(); if(now<t.readyAt){log('Ø­Ø§ÙˆÙ„Øª Ø§Ù„Ø­ØµØ§Ø¯ Ù…Ø¨ÙƒØ±Ù‹Ø§'); return;}
  state.storage[t.cropId]++; state.xp+=crop.xp; log(`Ø­ØµØ§Ø¯: ${crop.emoji} ${crop.name} â†’ ØªÙ… ÙˆØ¶Ø¹Ù‡ ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù† +${crop.xp} XP`); state.tiles[index]={cropId:null,plantedAt:0,readyAt:0}; save(); refreshUI(); refreshStorageUI();
}

function harvestAll(){let did=false; for(let i=0;i<state.tiles.length;i++){ const t=state.tiles[i]; if(t&&t.cropId&&Date.now()>=t.readyAt){harvestAt(i); did=true;}} if(!did)log('Ù„Ø§ Ù…Ø­Ø§ØµÙŠÙ„ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø­ØµØ§Ø¯ Ø§Ù„Ø¢Ù†');}

function computeLevel(xp){let lvl=1, rem=xp, need=100; while(rem>=need){rem-=need; lvl++; need=Math.floor(need*1.25); if(lvl>100) break;} return lvl;}

function refreshUI(){
  coinsEl.textContent=state.coins; xpEl.textContent=state.xp; lvlEl.textContent=computeLevel(state.xp);
  state.tiles.forEach((t,i)=>{const soil=document.getElementById('soil-'+i), info=document.getElementById('info-'+i), prog=document.getElementById('prog-'+i), tileEl=soil.parentElement; if(!t||!t.cropId){soil.textContent='ğŸŸ«'; info.textContent=''; prog.textContent=''; tileEl.classList.remove('ready'); return;} const crop=CROPS[t.cropId]; soil.textContent=crop.emoji; const now=Date.now(); if(now>=t.readyAt){prog.textContent='Ø¬Ø§Ù‡Ø² Ù„Ù„Ø­ØµØ§Ø¯'; tileEl.classList.add('ready');}else{prog.textContent=Math.ceil((t.readyAt-now)/1000)+'s'; tileEl.classList.remove('ready');} info.textContent=crop.name;});
}

function refreshStorageUI(){storageList.innerHTML=''; for(const id in state.storage){storageList.innerHTML+=`${CROPS[id].emoji} ${CROPS[id].name}: ${state.storage[id]}<br>`;}}

function startTicker(){setInterval(()=>{refreshUI(); if(Date.now()-state.lastSave>10000) save();},1000);}

function save(){state.lastSave=Date.now(); localStorage.setItem(SAVE_KEY,JSON.stringify(state));}

function resetGame(){state={coins:50,xp:0,tiles:Array(GRID_ROWS*GRID_COLS).fill(null).map(()=>({cropId:null,plantedAt:0,readyAt:0})),storage:{wheat:0,tomato:0,corn:0},lastSave:Date.now()}; save(); refreshUI(); refreshStorageUI(); log('Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£Ø¹ÙŠØ¯Øª Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©');}

function log(text){const p=document.createElement('div'); p.textContent=`[${new Date().toLocaleTimeString()}] ${text}`; logEl.prepend(p);}

init();
</script>
</body>
</html>
